{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"微信小程序\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/10/12/%E7%BC%96%E7%A8%8B/%E5%BE%AE%E4%BF%A1%E4%BA%91%E5%BC%80%E5%8F%91/",
            "url": "http://example.com/2023/10/12/%E7%BC%96%E7%A8%8B/%E5%BE%AE%E4%BF%A1%E4%BA%91%E5%BC%80%E5%8F%91/",
            "title": "微信云开发",
            "date_published": "2023-10-12T10:49:32.914Z",
            "content_html": "<h1 id=\"day1\"><a class=\"markdownIt-Anchor\" href=\"#day1\">#</a> day1</h1>\n<h2 id=\"增删查改\"><a class=\"markdownIt-Anchor\" href=\"#增删查改\">#</a> 增删查改</h2>\n<p>今天学会了在微信开发中如何对数据库进行增删改查，和进行页面之间的跳转，还有数据之间的传递。</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">database</span>().<span class=\"title function_\">collection</span>(<span class=\"string\">&#x27;goods&#x27;</span>)</span><br><span class=\"line\">            .<span class=\"title function_\">add</span>(&#123;</span><br><span class=\"line\">                <span class=\"attr\">data</span>:&#123;</span><br><span class=\"line\">                    <span class=\"attr\">name</span>:goodname,</span><br><span class=\"line\">                    <span class=\"attr\">price</span>:price</span><br><span class=\"line\">                &#125; </span><br><span class=\"line\">            &#125;)</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"id传递\"><a class=\"markdownIt-Anchor\" href=\"#id传递\">#</a> ID 传递</h2>\n<p>data-id 与后面获取的变量名 id 相对应</p>\n<div class=\"highlight-container\" data-rel=\"Html\"><figure class=\"iseeu highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">bindtap</span>=<span class=\"string\">&#x27;goDetail&#x27;</span> <span class=\"attr\">data-id</span>=<span class=\"string\">&quot;&#123;&#123;item._id&#125;&#125;&quot;</span>&gt;</span>商品名：&#123;&#123;item.name&#125;&#125;,价格：&#123;&#123;item.price&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">console.log(&quot;点击了跳转商品详情&quot;,event.currentTarget.dataset.id)</span><br></pre></td></tr></table></figure></div>\n<p><strong>在 app.json 中的 pages 新增页面，页面的次序是有影响的</strong></p>\n<h2 id=\"返回结果\"><a class=\"markdownIt-Anchor\" href=\"#返回结果\">#</a> 返回结果</h2>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">database</span>().<span class=\"title function_\">collection</span>(<span class=\"string\">&#x27;goods&#x27;</span>).<span class=\"title function_\">get</span>()</span><br><span class=\"line\">.<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span>=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;成功&#x27;</span>,res)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">.<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span>=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;失败&#x27;</span>,err)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<hr>\n<br/>\n<h1 id=\"day2\"><a class=\"markdownIt-Anchor\" href=\"#day2\">#</a> day2</h1>\n<p>通过封装方法，使用 this 进行调用，在使用<strong> this 时要注意所在的作用域</strong>。</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"title function_\">getList</span>()</span><br></pre></td></tr></table></figure></div>\n<p>使用全局变量来传递值，可以使用 let，也可以使用 var 变量</p>\n<p>可以在 updated 中的 status 中看出是否有更新成功，在对数据库进行操作时要注意权限问题</p>\n<p>使用 return 截断错误，方便调试</p>\n<p><strong>接受数字小心是字符串，可以通过是否变蓝看出，可以使用 parseInt (price) 来进行强制转换</strong></p>\n<p>可以使用变量接收数据库对象，来方便操作</p>\n<p>限制返回的数据条数 <code>.limit(3)</code></p>\n<p>跳过若干条数据，用于分页 <code>.skip(1)</code></p>\n<p><strong>要注意套餐所给的量，小心写，不然用完就要开新的套餐。数据库的读写次数是有限制的</strong></p>\n<h2 id=\"快捷键使用\"><a class=\"markdownIt-Anchor\" href=\"#快捷键使用\">#</a> 快捷键使用</h2>\n<table>\n<thead>\n<tr>\n<th>快捷键</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Ctrl+B</td>\n<td>编译</td>\n</tr>\n<tr>\n<td>Ctrl+z</td>\n<td>撤销操作</td>\n</tr>\n<tr>\n<td>Ctrl+s</td>\n<td>保存</td>\n</tr>\n<tr>\n<td>shift+Alt + 方向键</td>\n<td>向对应方向复制当前行</td>\n</tr>\n<tr>\n<td>Ctrl+ALT+l</td>\n<td>格式化代码</td>\n</tr>\n<tr>\n<td>shift+Alt+f</td>\n<td>全局搜索</td>\n</tr>\n<tr>\n<td>Ctrl+f</td>\n<td>当前页面搜索</td>\n</tr>\n<tr>\n<td>Ctrl+h</td>\n<td>查找并替换</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"绑定事件\"><a class=\"markdownIt-Anchor\" href=\"#绑定事件\">#</a> 绑定事件</h2>\n<p>前端界面绑定方法，bindtap 点击事件，bindinput 输入事件，然后在后端函数中获取值</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 前端页面</span></span><br><span class=\"line\">&lt;input bindinput=<span class=\"string\">&quot;getPrice&quot;</span>&gt;&lt;/input&gt;</span><br><span class=\"line\"><span class=\"comment\">// 后端页面</span></span><br><span class=\"line\"><span class=\"title function_\">getPrice</span>(<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">        price = event.<span class=\"property\">detail</span>.<span class=\"property\">value</span></span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"弹窗提示确认是否删除\"><a class=\"markdownIt-Anchor\" href=\"#弹窗提示确认是否删除\">#</a> 弹窗提示确认是否删除</h2>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"title function_\">showModal</span>(&#123;</span><br><span class=\"line\">          <span class=\"attr\">cancelColor</span>: <span class=\"string\">&#x27;cancelColor&#x27;</span>,</span><br><span class=\"line\">          <span class=\"attr\">title</span>:<span class=\"string\">&quot;是否确定删除&quot;</span>,</span><br><span class=\"line\">          <span class=\"attr\">content</span>:<span class=\"string\">&quot;您再仔细想一想，是否真的要删除，删除后不可恢复&quot;</span>,</span><br><span class=\"line\">          <span class=\"title function_\">success</span>(<span class=\"params\">res</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span>(res.<span class=\"property\">confirm</span>==<span class=\"literal\">true</span>)&#123;<span class=\"comment\">//用户点击了确认</span></span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;点击确定&#x27;</span>,res)</span><br><span class=\"line\">              &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(res.<span class=\"property\">cancel</span>==<span class=\"literal\">true</span>)&#123;<span class=\"comment\">//用户点击了取消</span></span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;点击取消&#x27;</span>,res)</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;)</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"页面跳转\"><a class=\"markdownIt-Anchor\" href=\"#页面跳转\">#</a> 页面跳转</h2>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"title function_\">navigateTo</span>(&#123;</span><br><span class=\"line\">              <span class=\"attr\">url</span>: <span class=\"string\">&#x27;/pages/demo1/demo1&#x27;</span>,</span><br><span class=\"line\">            &#125;)</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"升序排列\"><a class=\"markdownIt-Anchor\" href=\"#升序排列\">#</a> 升序排列</h2>\n<p>asc 表示升序，desc 为降序，前面是关键字</p>\n<div class=\"highlight-container\" data-rel=\"Plaintext\"><figure class=\"iseeu highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.orderBy(&quot;price&quot;,&#x27;asc&#x27;)</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"command命令筛选\"><a class=\"markdownIt-Anchor\" href=\"#command命令筛选\">#</a> command 命令筛选</h2>\n<p>可以在微信开放文档<a href=\"https://\"> https://developers.weixin.qq.com/miniprogram/dev/wxcloud/reference-sdk-api/database/Command.html</a> 中查看具体，常见的有 gt 大于，lt 小于，gte 大于等于</p>\n<p>还可以使用 and 关键字设置多个查找条件，要注意格式 and ([]),[] 中用 {} 包裹筛选条件</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.<span class=\"title function_\">where</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">price</span>:db.<span class=\"property\">command</span>.<span class=\"title function_\">gt</span>(<span class=\"number\">10</span>),</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 组合查找</span></span><br><span class=\"line\">.<span class=\"title function_\">where</span>(_.<span class=\"title function_\">and</span>([&#123;</span><br><span class=\"line\">            <span class=\"attr\">price</span>: _.<span class=\"title function_\">gt</span>(<span class=\"number\">10</span>)</span><br><span class=\"line\">        &#125;, <span class=\"comment\">//大于10</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">price</span>: _.<span class=\"title function_\">lt</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">        &#125;, <span class=\"comment\">//小于20</span></span><br><span class=\"line\">    ]))</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"云函数\"><a class=\"markdownIt-Anchor\" href=\"#云函数\">#</a> 云函数</h2>\n<h3 id=\"初始化云函数\"><a class=\"markdownIt-Anchor\" href=\"#初始化云函数\">#</a> 初始化云函数</h3>\n<p>新增的文件夹一定要与 pages 平级，可以先点击与 pages 平级的文件，再点击新增文件夹，命名为 cloud，或者在云函数列表中右键新增 node.js 云函数</p>\n<p>在 project.config.json 文件顶部配置云函数所在目录为 cloud，可以根据喜欢换名字，只要能对应起来就可以</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;cloudfunctionRoot&quot;</span>:<span class=\"string\">&quot;/cloud&quot;</span>,</span><br></pre></td></tr></table></figure></div>\n<p>保存成功，此时 cloud 文件夹会出现云朵标志，代表初始化成功</p>\n<h3 id=\"注意事项\"><a class=\"markdownIt-Anchor\" href=\"#注意事项\">#</a> 注意事项</h3>\n<p>要注意云函数的环境要和小程序的环境对应</p>\n<p>文件夹右键选择新建 node.js 文件</p>\n<h3 id=\"云函数的调用\"><a class=\"markdownIt-Anchor\" href=\"#云函数的调用\">#</a> 云函数的调用</h3>\n<p>使用 callFunction, 在 name 处填写需要调用的云函数名称</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//云函数的调用</span></span><br><span class=\"line\"><span class=\"comment\">//传统写法</span></span><br><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">callFunction</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;getData&#x27;</span>,</span><br><span class=\"line\">    <span class=\"title function_\">success</span>(<span class=\"params\">res</span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;请求云函数成功&#x27;</span>,res)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">fail</span>(<span class=\"params\">err</span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;请求云函数失败&#x27;</span>,res)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// 建议写法</span></span><br><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">callFunction</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;getData&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">.<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;成功&#x27;</span>, res)</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">setData</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 传递值</span></span><br><span class=\"line\">        <span class=\"attr\">openid</span>: res.<span class=\"property\">result</span>.<span class=\"property\">openid</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">.<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;失败&#x27;</span>, err)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"云函数获取数据\"><a class=\"markdownIt-Anchor\" href=\"#云函数获取数据\">#</a> 云函数获取数据</h3>\n<p>云函数只要有变动，就要重新部署，否则云函数不生效</p>\n<p>部署选择上传并部署：云端安装依赖 (不上传 node_modules)</p>\n<p>如果只改变了 js 文件，可点击对应的 js 文件，右键选择云函数增量上传：更新文件</p>\n<p>而且在云函数中操作数据库时，不再需要写 wx，wx 只在本地编写的时候才需要写</p>\n<p><strong>有多个云开发环境的时候，需要指定环境，或者使用 DYNAMIC_CURRENT_ENV 指定为当前环境（提倡写法）</strong></p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cloud.<span class=\"title function_\">init</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">env</span>: cloud.<span class=\"property\">DYNAMIC_CURRENT_ENV</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<hr>\n<h1 id=\"day3\"><a class=\"markdownIt-Anchor\" href=\"#day3\">#</a> day3</h1>\n<p>文件可以导出为 json 格式，可以使用记事本进行打开</p>\n<p>导入的时候可以选择 insert 和 upsert 模式，使用 insert 时注意不要有多个 id 相同的情况出现，否则会报错。建议使用 upsert 模式。</p>\n<p>云函数一次最多可返回 100 条数据，本地一次最多可返回 20 条数据。</p>\n<p><strong>云函数中 console 在云端打印，我们在调试器中只能看到本地的 console。</strong></p>\n<h2 id=\"向云函数传递值\"><a class=\"markdownIt-Anchor\" href=\"#向云函数传递值\">#</a> 向云函数传递值</h2>\n<p>在 data 中传递值，在云函数中使用 event 接收对应的值</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">callFunction</span>(&#123;</span><br><span class=\"line\">    name = <span class=\"string\">&#x27;update0129&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">data</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">id</span>:id,</span><br><span class=\"line\">        <span class=\"attr\">price</span>:<span class=\"number\">20</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// 云函数</span></span><br><span class=\"line\">event.<span class=\"property\">id</span>和event.<span class=\"property\">price</span></span><br></pre></td></tr></table></figure></div>\n<hr>\n<h1 id=\"day4\"><a class=\"markdownIt-Anchor\" href=\"#day4\">#</a> day4</h1>\n<p>在编写云函数时，要注意先保存再上传到云端。</p>\n<p>创建云函数不难，相当于把本地的代码移到云函数，去掉 wx</p>\n<p>可以导入源码，但是如果使用别人的源码需要改开发者 ID</p>\n<h2 id=\"选择文件接口\"><a class=\"markdownIt-Anchor\" href=\"#选择文件接口\">#</a> 选择文件接口</h2>\n<p><strong>用户选择文件接口（api)</strong></p>\n<p><a href=\"https://\">https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.chooseMedia.html</a></p>\n<p>也可以选择 chooseImage 接口</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">chooseImg</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//上传图片的第一步</span></span><br><span class=\"line\">    wx.<span class=\"title function_\">chooseImage</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">count</span>: <span class=\"number\">1</span>, <span class=\"comment\">//可以选择多少张图片</span></span><br><span class=\"line\">        <span class=\"attr\">sizeType</span>: [<span class=\"string\">&#x27;original&#x27;</span>, <span class=\"string\">&#x27;compressed&#x27;</span>],</span><br><span class=\"line\">        <span class=\"attr\">sourceType</span>: [<span class=\"string\">&#x27;album&#x27;</span>, <span class=\"string\">&#x27;camera&#x27;</span>], <span class=\"comment\">//设置图片来源</span></span><br><span class=\"line\">        <span class=\"attr\">success</span>:<span class=\"function\"><span class=\"params\">res</span>=&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">uploadImg</span>(res.<span class=\"property\">tempFilePaths</span>[<span class=\"number\">0</span>])</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"文件上传\"><a class=\"markdownIt-Anchor\" href=\"#文件上传\">#</a> 文件上传</h2>\n<p>然后就可以对获取到的文件进行上传</p>\n<p><a href=\"https://\">https://developers.weixin.qq.com/miniprogram/dev/wxcloud/reference-sdk-api/storage/uploadFile/client.uploadFile.html</a></p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">uploadImg</span>(<span class=\"params\">temfile</span>)&#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;要上传图片的临时路径&#x27;</span>,temfile)</span><br><span class=\"line\">    wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">uploadFile</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">cloudPath</span>: <span class=\"string\">&#x27;西芹1.png&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">filePath</span>: temfile, <span class=\"comment\">// 文件路径</span></span><br><span class=\"line\">        <span class=\"attr\">success</span>: <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;上传成功&#x27;</span>,res)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">fail</span>: <span class=\"function\"><span class=\"params\">err</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;上传失败&#x27;</span>,err)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>点击预览即可在手机上体验使用小程序上传图片</p>\n<h1 id=\"day5\"><a class=\"markdownIt-Anchor\" href=\"#day5\">#</a> day5</h1>\n<p>存储图片路径，使用存储中的下载地址，复制的时候注意不要复制问号后面的东西，因为是时间戳，可能导致图片失效。</p>\n<h2 id=\"上传视频\"><a class=\"markdownIt-Anchor\" href=\"#上传视频\">#</a> 上传视频</h2>\n<p><a href=\"https://\">https://developers.weixin.qq.com/miniprogram/dev/api/media/video/wx.chooseVideo.html</a></p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"title function_\">chooseVideo</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">sourceType</span>: [<span class=\"string\">&#x27;album&#x27;</span>,<span class=\"string\">&#x27;camera&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">maxDuration</span>: <span class=\"number\">60</span>,</span><br><span class=\"line\">  <span class=\"attr\">camera</span>: <span class=\"string\">&#x27;back&#x27;</span>,</span><br><span class=\"line\">  <span class=\"title function_\">success</span>(<span class=\"params\">res</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res.<span class=\"property\">tempFilePath</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<p>上传视频有时候比较慢，需要耐心等待。</p>\n<p>通过 type 值判断是上传视频还是图片</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;image <span class=\"attr\">wx</span>:<span class=\"keyword\">if</span>=<span class=\"string\">&quot;&#123;&#123;showImg&#125;&#125;&quot;</span> src=<span class=\"string\">&quot;&#123;&#123;imgUrl&#125;&#125;&quot;</span>&gt;&lt;/image&gt;</span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">video</span> <span class=\"attr\">wx:if</span>=<span class=\"string\">&quot;&#123;&#123;showVideo&#125;&#125;&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;&#123;&#123;videoUrl&#125;&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>\n<h2 id=\"上传word和pdf文件\"><a class=\"markdownIt-Anchor\" href=\"#上传word和pdf文件\">#</a> 上传 Word 和 PDF 文件</h2>\n<p><a href=\"https://\">https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.chooseMessageFile.html</a></p>\n<p>从客户端会话选择文件。</p>\n<div class=\"highlight-container\" data-rel=\"Plaintext\"><figure class=\"iseeu highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.chooseMessageFile(&#123;</span><br><span class=\"line\">  count: 10,</span><br><span class=\"line\">  type: &#x27;image&#x27;,</span><br><span class=\"line\">  success (res) &#123;</span><br><span class=\"line\">    // tempFilePath可以作为img标签的src属性显示图片</span><br><span class=\"line\">    const tempFilePaths = res.tempFiles</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"文件下载\"><a class=\"markdownIt-Anchor\" href=\"#文件下载\">#</a> 文件下载</h2>\n<p><a href=\"https://\">https://developers.weixin.qq.com/miniprogram/dev/wxcloud/reference-sdk-api/storage/downloadFile/client.downloadFile.html</a></p>\n<p>从云存储空间下载文件</p>\n<div class=\"highlight-container\" data-rel=\"Javascript\"><figure class=\"iseeu highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wx.<span class=\"property\">cloud</span>.<span class=\"title function_\">downloadFile</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">fileID</span>: <span class=\"string\">&#x27;a7xzcb&#x27;</span></span><br><span class=\"line\">&#125;)&#125;).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;下载成功&#x27;</span>)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">catch</span>(<span class=\"function\"><span class=\"params\">error</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;下载失败&#x27;</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></div>\n<h1 id=\"day6\"><a class=\"markdownIt-Anchor\" href=\"#day6\">#</a> day6</h1>\n<p>vue 文件中，data 初始化需要使用的数据，生命周期函数写在 methods 外面，而自定义的函数写在 methods 内。</p>\n<p><strong>传递值不需要 setdata，只需要 this. 变量名 = 值即可。</strong></p>\n<h2 id=\"目录结构\"><a class=\"markdownIt-Anchor\" href=\"#目录结构\">#</a> 目录结构</h2>\n<table>\n<thead>\n<tr>\n<th>目录名</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>pages</td>\n<td>页面存放目录</td>\n</tr>\n<tr>\n<td>static</td>\n<td>静态文件目录</td>\n</tr>\n<tr>\n<td>APP.vue</td>\n<td>应用入口文件，和小程序 app.js 类似</td>\n</tr>\n<tr>\n<td>main.js</td>\n<td>应用入口文件，注册 vue 等</td>\n</tr>\n<tr>\n<td>manifest.json</td>\n<td>项目配置</td>\n</tr>\n<tr>\n<td>pages.json</td>\n<td>页面配置</td>\n</tr>\n<tr>\n<td>common</td>\n<td>存放共用的文件</td>\n</tr>\n<tr>\n<td>components</td>\n<td>自定义组件目录</td>\n</tr>\n<tr>\n<td>store</td>\n<td>vuex 目录</td>\n</tr>\n<tr>\n<td>unpackage</td>\n<td>编译后的文件目录</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"前端控制语句\"><a class=\"markdownIt-Anchor\" href=\"#前端控制语句\">#</a> 前端控制语句</h2>\n<table>\n<thead>\n<tr>\n<th>函数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>v-bind</td>\n<td>可以简写为：，组件属性要使用 data 中定义的数据变量，或者组件属性使用表达式，要使用 v-bind 指定</td>\n</tr>\n<tr>\n<td>v-on</td>\n<td>可以简写为 @绑定事件</td>\n</tr>\n<tr>\n<td>v-model</td>\n<td>数据双向绑定，例如根据输入值动态改变 data 中的值</td>\n</tr>\n<tr>\n<td>v-if</td>\n<td>条件判断，决定某个内容或者区块是否挂载</td>\n</tr>\n<tr>\n<td>v-show</td>\n<td>条件判断，是否显示</td>\n</tr>\n<tr>\n<td>v-for</td>\n<td>列表渲染，遍历循环，可以使用 index 获取序号，可以使用 value 和 key 获取对象中的对应关系</td>\n</tr>\n</tbody>\n</table>\n<p>onclick 事件也能够通过写表达式改变值，.stop 可以阻止事件穿透</p>\n<h2 id=\"生命周期\"><a class=\"markdownIt-Anchor\" href=\"#生命周期\">#</a> 生命周期</h2>\n<h3 id=\"应用的生命周期appvue\"><a class=\"markdownIt-Anchor\" href=\"#应用的生命周期appvue\">#</a> 应用的生命周期（APP.vue)</h3>\n<table>\n<thead>\n<tr>\n<th>周期名</th>\n<th>意义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>onLaunch</td>\n<td>应用初始化完成执行，全局只执行一次，通常做登录的处理</td>\n</tr>\n<tr>\n<td>onShow</td>\n<td>应用显示时执行，或者从后台进入前台</td>\n</tr>\n<tr>\n<td>onHide</td>\n<td>应用隐藏时执行，或者从前台进入后台</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"页面的生命周期\"><a class=\"markdownIt-Anchor\" href=\"#页面的生命周期\">#</a> 页面的生命周期</h3>\n<p>onReady 在 onShow 之后触发，因为要等待数据</p>\n<table>\n<thead>\n<tr>\n<th>周期名</th>\n<th>意义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>onLoad</td>\n<td>页面加载时触发</td>\n</tr>\n<tr>\n<td>onReady</td>\n<td>页面初次完成渲染时触发</td>\n</tr>\n<tr>\n<td>onShow</td>\n<td>页面显示时触发</td>\n</tr>\n<tr>\n<td>onUnload</td>\n<td>页面卸载时触发</td>\n</tr>\n<tr>\n<td>onHide</td>\n<td>页面隐藏时触发</td>\n</tr>\n</tbody>\n</table>\n<p><strong>在写完云函数之后，一定要先停止在模拟器上运行，在编译一次才可以的，然后上传到云端，就可以进行使用了</strong></p>\n<p><strong>v-model 真的是神器，省去了很多获取值的麻烦操作</strong></p>\n",
            "tags": [
                "云开发",
                "微信小程序"
            ]
        }
    ]
}